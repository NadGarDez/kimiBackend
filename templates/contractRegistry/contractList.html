{% extends "base.html" %}
{% load static %}

{% block title %}Registry - Lista de Contratos{% endblock %}

{% block content %}

<div class="centered-container mx-auto dashboard-content">
    
    <div class="d-flex justify-content-between align-items-center mb-2">
        
        <h2 class="h3 text-accent mb-0" style="border-bottom: none !important;">Registro de Contratos Base</h2>
        
        <a href="{% url 'contractRegistry:register_contract' %}" 
           class="btn btn-accent rounded-circle p-0" 
           style="width: 40px; height: 40px; line-height: 40px; font-size: 1.5rem; display: flex; align-items: center; justify-content: center;"
           title="Agregar Nuevo Contrato">
            
            <i class="bi bi-plus-lg fw-bold text-dark"></i> 
        </a>
    </div>
    
    <hr class="text-accent mt-0 mb-2"> 
    
    <div class="mb-2 welcome-card p-3">
        <p class="mb-0 text-text-dim">
            Aquí se encuentran todos los contratos base (ej. HashPoolAdmin, TicketManager) registrados en el sistema, listos para ser versionados y desplegados.
        </p>
    </div>

    {% if contracts %}
        <div class="card status-card-table p-3" style="max-height: 500px; overflow-y: auto;">
            <div class="table-responsive">
                <table class="table table-dark table-striped table-hover mb-0"> 
                    <thead class="bg-dark sticky-top">
                        <tr>
                            <th scope="col" class="text-accent fw-bold">#</th>
                            <th scope="col" class="text-accent fw-bold">Nombre del Contrato</th>
                            <th scope="col" class="text-accent fw-bold">Última Versión Registrada</th>
                            <th scope="col" class="text-accent fw-bold">Fecha de Registro</th>
                            <th scope="col" class="text-accent fw-bold">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for contract in contracts %}
                            <tr class="align-middle">
                                <th scope="row">{{ forloop.counter }}</th>
                                
                                <td class="fw-bold text-light">{{ contract.name }}</td>
                                
                                <td class="text-text-dim">v1.0.0 (Estática)</td> 
                                
                                <td class="text-text-dim">{{ contract.created_at|date:"Y-m-d" }}</td>
                                
                                <td>
                                    <a href="{% url 'contractRegistry:contract_detail' contract.pk %}" class="btn btn-sm btn-outline-info fw-bold">
                                        Ver
                                    </a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    
    {% else %}
        <div class="card p-5 text-center bg-dark mt-4 border border-warning">
            <i class="bi bi-box-seam-fill text-warning" style="font-size: 3rem;"></i>
            <h4 class="text-warning mt-3">¡No hay Contratos Base registrados!</h4>
            <p class="text-text-dim mb-4">
                Parece que esta lista está vacía. Para empezar a trabajar, debes registrar un nuevo tipo de contrato (ej. `ERC20`).
            </p>
            <a href="{% url 'contractRegistry:register_contract' %}" 
               class="btn btn-warning fw-bold mx-auto" style="width: 250px;">
                <i class="bi bi-folder-plus me-2"></i> Registrar Primer Contrato
            </a>
        </div>
    {% endif %}

</div>

{% endblock %}
